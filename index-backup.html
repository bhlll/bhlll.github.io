<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="main.css">
</head>

<body>
  <div class="container">

    <!-- <h1>MBYI-211 测试</h1> -->
    <!-- PAGE1 welcome -->
    <div class="page" id='home'>
        <button class="" id='start-btn'></button>
    </div>
    <!-- PAGE2  quiz -->
    <div class="page"  id = 'quiz-page'>
      <div class="page-content">
        <div class="quiz-container">
          <div id="quiz"></div>
        </div>
        <div class="buttons" id = 'quiz-btns'>
          <button id="previous">上一个问题</button>
          <button id="next">下一个问题</button>
          <button id="submit">提交答案</button>
        </div>
      </div>
    </div>
  </div>
  <!-- PAGE 3 username -->
  <div class="page" id = 'username-page'>
    <div class="page-content">
      <!-- <div>
        勇士，
        感谢你拯救了梦想岛
        在你离开前，绿油油的小精灵还有一个问题
      </div>
      <div>
        “我们仍未知道那天拯救了，梦想岛的勇士的姓名”
      </div> -->
      <label for="fname"></label>
      <input type="text" id="username" name="username" class="username" autofocus>
      <div class="buttons" id = 'confirmBtn'>
        <button id="showPosterButton">确认</button>
      </div>
    </div>
  </div>
  <!-- PAGE 4 poster-->
  <div class="page" id="resultPoster">
    <div class="page-content">
      <div id="results" style='width: 100%; height: 100%;'>
      </div>
      <div class="buttons" id="saveButtons">
        <button id="backToHomeButton">时空循环</button>
        <button id="saveButton" onclick="screenshot()">保存</button>
      </div>
    </div>
  </div>
  <div class="page" id="toSaveResultPoster">
    <div class="page-content">
      <div id="result-image">
        <!-- <image src = "img/poster/A.jpg"></image> -->
      </div>
      <!-- <div class="buttons" id="saveButtons">
        <button id="backToHomeButton">时空循环</button>
        <button id="saveButton" onclick="screenshot()">保存</button>
      </div> -->
    </div>
  </div>
  <canvas id="result-canvas" style='display: none;'></canvas>
  <script src="./data.js"></script>
  <script src="./main.js"></script>
  <script>
    function screenshot() {
      const canvas = document.querySelector("canvas");
      const resultImage = document.getElementById('result-image');
      const username = document.getElementById("username").value;

      canvas.width  = window.innerWidth;
      canvas.height = window.innerHeight;
      const context = canvas.getContext("2d");
      const imageObj = new Image();
      imageObj.onload = () => {
        context.drawImage(imageObj, 0, 0, window.innerWidth, window.innerHeight);
        context.font = "40pt Calibri";
        context.fillStyle = 'white';
        context.fillText(username, 150,  window.innerHeight * 0.55);

        var canvas = document.getElementById('result-canvas');
        var dataURL = canvas.toDataURL();
        resultImage.src = dataURL;
      };
      imageObj.src = resultImage.src;
    }
  </script>
</body>

</html>