<!DOCTYPE html>
<html>

  <head>
    <link rel="stylesheet" href="main.css">
  </head>

<body>
  <div>
    <div id="results">
      <h1>测试用户</h1>
      <img id="result-image" src="./img/poster/A.jpg" width="100%" height="100%"/>
      <canvas id="idCanvas" style='width: 200px; height: 300px; display: none;'></canvas>
    </div>
    <button id="open-popup" style="font-size: 24px;" onclick="screenshot()">截屏</button>
  </div>

  <div id="myModal" class="modal">

    <!-- The Close Button -->
    <span class="close">&times;</span>
  
    <!-- Modal Content (The Image) -->
    <img class="modal-content" id="img01" name="result">
  
    <!-- Modal Caption (Image Text) -->
    <div id="caption"></div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html-to-image/1.9.0/html-to-image.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <!-- <script type="text/javascript" src="w2ui-1.5.min.js"></script>
  <link rel="stylesheet" type="text/css" href="w2ui-1.5.min.css" /> -->
  <script>
    let modal = document.getElementById("myModal");
    let modalImg = document.getElementById("img01");
    let captionText = document.getElementById("caption");

    function screenshot() {
      const canvas = document.querySelector("canvas");
      canvas.width  = window.innerWidth;
      canvas.height = window.innerHeight;
      const context = canvas.getContext("2d");
      const imageObj = new Image();
      imageObj.onload = () => {
        context.drawImage(imageObj, 0, 0);
        context.font = "40pt Calibri";
        context.fillText("hello!", 20, 20);

        var canvas = document.getElementById('idCanvas');
        var dataURL = canvas.toDataURL();
        modal.style.display = "block";
        modalImg.src = dataURL;
      };
      imageObj.src = "./img/poster/A.jpg";
    }

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
      modal.style.display = "none";
    }

  </script>
</body>

</html>